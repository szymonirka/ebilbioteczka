<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Szczeg√≥≈Çy ksiƒÖ≈ºki</title>
</head>
<body>
<h1>Szczeg√≥≈Çy ksiƒÖ≈ºki</h1>
<div id="book_details"></div>
<div id="fav_buttons" style="margin-top: 10px;">
    <button onclick="addToFavorites()">üíñ Dodaj do ulubionych</button>
    <button onclick="removeFromFavorites()">‚ùå Usu≈Ñ z ulubionych</button>
</div>
<a href="index.html">‚Üê Powr√≥t do listy</a>

<script>
    let bookId;
    const token = localStorage.getItem('token');
    async function loadBookDetails() {
        const params = new URLSearchParams(window.location.search);
        bookId = params.get('id');

        if (!bookId) {
            document.getElementById('book_details').textContent = 'Brak ID ksiƒÖ≈ºki';
            return;
        }

        try {
            const res = await fetch(`/api/books/${bookId}`);
            const book = await res.json();

            document.getElementById('book_details').innerHTML = `
                    <h2>${book.title}</h2>
                    <p><strong>Autor:</strong> ${book.author}</p>
                    <p><strong>ID:</strong> ${book.id}</p>
                    <!-- Mo≈ºesz dodaƒá wiƒôcej szczeg√≥≈Ç√≥w, np. tre≈õƒá -->
                `;
        } catch (err) {
            document.getElementById('book_details').textContent = '‚ùå B≈ÇƒÖd ≈Çadowania ksiƒÖ≈ºki';
        }
    }

    async function addToFavorites() {
        if (!token) {
            alert("Musisz byƒá zalogowany, by dodaƒá do ulubionych.");
            return;
        }

        try {
            const res = await fetch(`/api/favorites/${bookId}`, {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + token
                }
            });
            const data = await res.json();
            alert(data.message || 'Dodano do ulubionych');
        } catch (err) {
            alert('‚ùå B≈ÇƒÖd dodawania do ulubionych');
        }
    }

    async function removeFromFavorites() {
        if (!token) {
            alert("Musisz byƒá zalogowany, by usunƒÖƒá z ulubionych.");
            return;
        }

        try {
            const res = await fetch(`/api/favorites/${bookId}`, {
                method: 'DELETE',
                headers: {
                    'Authorization': 'Bearer ' + token
                }
            });
            const data = await res.json();
            alert(data.message || 'Usuniƒôto z ulubionych');
        } catch (err) {
            alert('‚ùå B≈ÇƒÖd usuwania z ulubionych');
        }
    }

    window.addEventListener('DOMContentLoaded', loadBookDetails);
</script>
</body>
</html>
